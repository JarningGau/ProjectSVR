<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Quick start of ProjectSVR â€¢ ProjectSVR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Quick start of ProjectSVR"><meta property="og:description" content="ProjectSVR"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-W1XR84YEPZ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-W1XR84YEPZ');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ProjectSVR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/quick_start.html">Quick start</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/JarningGau/ProjectSVR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>





<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quick start of ProjectSVR</h1>
            
            <h4 data-toc-skip class="date">Compiled: July 21, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JarningGau/ProjectSVR/blob/HEAD/vignettes/quick_start.Rmd" class="external-link"><code>vignettes/quick_start.Rmd</code></a></small>
      <div class="hidden name"><code>quick_start.Rmd</code></div>

    </div>

    
    
<div id="download-related-dataset" class="section level2">
<h2>Download related dataset</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ProjectSVR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Seurat)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">timeout =</span> <span class="fu">max</span>(<span class="dv">3600</span>, <span class="fu">getOption</span>(<span class="st">&quot;timeout&quot;</span>)))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">%notin%</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">Negate</span>(<span class="st">`</span><span class="at">%in%</span><span class="st">`</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reference data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">&quot;https://zenodo.org/record/8147304/files/disco_pbmc_small.seurat.slim.rds&quot;</span>, <span class="at">destfile =</span> <span class="st">&quot;disco_pbmc_small.seurat.slim.rds&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># query data</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">&quot;https://zenodo.org/record/8147304/files/query_pbmc_small.seurat.slim.rds&quot;</span>, <span class="at">destfile =</span> <span class="st">&quot;query_pbmc_small.seurat.slim.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="build-reference-model" class="section level2">
<h2>Build Reference Model</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>seu.ref <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;disco_pbmc_small.seurat.slim.rds&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(seu.ref, <span class="at">pt.size =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> seu.ref<span class="sc">@</span>misc<span class="sc">$</span>data.refplot<span class="sc">$</span>colors) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">inherit.aes =</span> F, <span class="at">data =</span> seu.ref<span class="sc">@</span>misc<span class="sc">$</span>data.refplot<span class="sc">$</span>text.pos,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(x, y, <span class="at">label =</span> label), <span class="at">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="quick_start_files/figure-html/load_reference-1.png" width="864" /></p>
<div id="extract-signatures" class="section level3">
<h3>Extract signatures</h3>
<p>Here we extract the top25 marker genes for each cell type (ribosomal and mitochondrial genes were removed).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ribo.genes)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">Idents</span>(seu.ref))</span></code></pre></div>
<pre><code>## 
##               memory CD4 T                    CD16 NK 
##                        200                        200 
##                   memory B                naive CD4 T 
##                        200                        200 
##                 GZMB CD8 T         proliferation T/NK 
##                        200                        200 
##                naive CD8 T            cytotoxic CD4 T 
##                        200                        200 
##                    naive B                       Treg 
##                        200                        200 
##                    GZMK NK                 GZMK CD8 T 
##                        200                        200 
##                       MAIT              CD16 monocyte 
##                        200                        200 
##              CD14 monocyte                   platelet 
##                        200                        200 
##                plasma cell         CD14/CD16 monocyte 
##                        200                        200 
##                        pDC                        cDC 
##                        200                        200 
##                 neutrophil                        RBC 
##                        200                        200 
## proliferation myeloid cell                        HSC 
##                        110                        108</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>seu.ref[[<span class="st">&quot;RNA&quot;</span>]]<span class="sc">@</span>counts <span class="ot">&lt;-</span> seu.ref[[<span class="st">&quot;RNA&quot;</span>]]<span class="sc">@</span>data</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>seu.ref <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(seu.ref)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>all.markers <span class="ot">&lt;-</span> <span class="fu">mcFindAllMarkers</span>(seu.ref, <span class="at">do.flatten =</span> F, <span class="at">n.cores =</span> <span class="dv">20</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>top.genes <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all.markers, <span class="cf">function</span>(xx){</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  yy <span class="ot">&lt;-</span> <span class="fu">subset</span>(xx, p_val_adj <span class="sc">&lt;</span> <span class="fl">1e-6</span> <span class="sc">&amp;</span> avg_log2FC <span class="sc">&gt;</span> <span class="fu">log2</span>(<span class="fl">1.5</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  yy <span class="ot">&lt;-</span> <span class="fu">subset</span>(yy, Gene.name.uniq <span class="sc">%notin%</span> ribo.genes)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  yy <span class="ot">&lt;-</span> yy[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;^MT-&quot;</span>, yy<span class="sc">$</span>Gene.name.uniq), ]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(yy<span class="sc">$</span>Gene.name.uniq, <span class="dv">25</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(top.genes, length)</span></code></pre></div>
<pre><code>##               memory CD4 T                    CD16 NK 
##                         25                         25 
##                   memory B                naive CD4 T 
##                         25                         25 
##                 GZMB CD8 T         proliferation T/NK 
##                         25                         25 
##                naive CD8 T            cytotoxic CD4 T 
##                         25                         25 
##                    naive B                       Treg 
##                         25                         25 
##                    GZMK NK                 GZMK CD8 T 
##                         25                         25 
##                       MAIT              CD16 monocyte 
##                         25                         25 
##              CD14 monocyte                   platelet 
##                         25                         25 
##                plasma cell         CD14/CD16 monocyte 
##                         25                         25 
##                        pDC                        cDC 
##                         25                         25 
##                 neutrophil                        RBC 
##                         25                         25 
## proliferation myeloid cell                        HSC 
##                         25                         25</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the gene set</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [Note] Avoid to use &#39;_&#39; or &#39;-&#39; in the gene set names.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(top.genes) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;feature.&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(top.genes))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the background genes are the union of all markers</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>bg.genes <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c, top.genes) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span></code></pre></div>
</div>
<div id="transfer-raw-count-matrix-to-gene-set-score-matrix" class="section level3">
<h3>Transfer raw count matrix to gene set score matrix</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>seu.ref <span class="ot">&lt;-</span> <span class="fu">ComputeModuleScore</span>(seu.ref, <span class="at">gene.sets =</span> top.genes, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">bg.genes =</span> bg.genes, <span class="at">method =</span> <span class="st">&quot;UCell&quot;</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cores =</span> <span class="dv">20</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The signature score matrix is stored in &#39;SignatureScore&#39; assay</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Assays</span>(seu.ref)</span></code></pre></div>
<pre><code>## [1] &quot;RNA&quot;            &quot;SignatureScore&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DefaultAssay</span>(seu.ref) <span class="ot">&lt;-</span> <span class="st">&quot;SignatureScore&quot;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot</span>(seu.ref, <span class="at">features =</span> <span class="st">&quot;feature.1&quot;</span>, <span class="at">pt.size =</span> .<span class="dv">3</span>)</span></code></pre></div>
<p><img src="quick_start_files/figure-html/add_gene_module_score-1.png" width="480" /></p>
</div>
<div id="training-reference-model" class="section level3">
<h3>Training reference model</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gss.mat <span class="ot">&lt;-</span> <span class="fu">FetchData</span>(seu.ref, <span class="at">vars =</span> <span class="fu">rownames</span>(seu.ref))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>embeddings.df <span class="ot">&lt;-</span> <span class="fu">FetchData</span>(seu.ref, <span class="at">vars =</span> <span class="fu">paste0</span>(<span class="st">&quot;UMAP_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>batch.size <span class="ot">=</span> <span class="dv">4000</span> <span class="co"># number of subsampled cells for each SVR model </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>n.models <span class="ot">=</span> <span class="dv">5</span>      <span class="co"># number of SVR models trained</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>umap.model <span class="ot">&lt;-</span> <span class="fu">FitEnsembleSVM</span>(<span class="at">feature.mat =</span> gss.mat,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">emb.mat =</span> embeddings.df,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">batch.size =</span> batch.size,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">n.models =</span> n.models,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">cores =</span> <span class="dv">5</span>)</span></code></pre></div>
</div>
<div id="save-the-reference-model" class="section level3">
<h3>Save the reference model</h3>
<p>ref.cellmeta stores:</p>
<ol style="list-style-type: decimal">
<li><p>[optional] colors: for plots</p></li>
<li><p>[optional] text.pos: text annotation on the reference plots</p></li>
<li><p>meta.data: cell meta data (embeddings + cell type information)</p></li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ref.cellmeta <span class="ot">&lt;-</span> seu.ref<span class="sc">@</span>misc<span class="sc">$</span>data.refplot</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ref.cellmeta<span class="sc">$</span>meta.data <span class="ot">&lt;-</span> <span class="fu">FetchData</span>(seu.ref, <span class="at">vars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;UMAP_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="st">&quot;cell_type&quot;</span>, <span class="st">&quot;cell_subtype&quot;</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>reference <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;models&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;umap&quot;</span> <span class="ot">=</span> umap.model</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;genes&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;gene.sets&quot;</span> <span class="ot">=</span> top.genes, <span class="co"># list</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;bg.genes&quot;</span> <span class="ot">=</span> bg.genes <span class="co"># vector</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;ref.cellmeta&quot;</span> <span class="ot">=</span> ref.cellmeta <span class="co"># list for reference plot</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(reference, <span class="st">&quot;model.disco_pbmc_quickstart.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="map-query-to-reference" class="section level2">
<h2>Map Query to Reference</h2>
<div id="reference-mapping" class="section level3">
<h3>Reference mapping</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>reference <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;model.disco_pbmc_quickstart.rds&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>seu.q <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;query_pbmc_small.seurat.slim.rds&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>seu.q[[<span class="st">&quot;RNA&quot;</span>]]<span class="sc">@</span>counts <span class="ot">&lt;-</span> seu.q[[<span class="st">&quot;RNA&quot;</span>]]<span class="sc">@</span>data</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>seu.q <span class="ot">&lt;-</span> ProjectSVR<span class="sc">::</span><span class="fu">MapQuery</span>(seu.q, <span class="at">reference =</span> reference, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">add.map.qual =</span> T, <span class="at">ncores =</span> <span class="dv">5</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">DimPlot</span>(seu.q, <span class="at">reduction =</span> <span class="st">&quot;ref.umap&quot;</span>, <span class="at">group.by =</span> <span class="st">&quot;donor&quot;</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">DimPlot</span>(seu.q, <span class="at">reduction =</span> <span class="st">&quot;ref.umap&quot;</span>, <span class="at">group.by =</span> <span class="st">&quot;cell_subtype&quot;</span>, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> T)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">&amp;</span> ggsci<span class="sc">::</span><span class="fu">scale_color_d3</span>(<span class="st">&quot;category20&quot;</span>)</span></code></pre></div>
<p><img src="quick_start_files/figure-html/reference_mapping-1.png" width="1152" /></p>
</div>
<div id="maping-quality" class="section level3">
<h3>Maping quality</h3>
<p>The metric for evaluating the mapping quality is essential for users to identify and discard erroneous projected cells. We introduce the mean kNN distance and demonstrate its utilization for quality control in reference mapping using ProjectSVR.</p>
<p>We believe that a good projection means the local topological relationship should be kept after projection. Thus we build a nearest neighbor (NN) graph in feature space (signature score matrix) and measure the average distance of its K nearest neighbors (called <code>mean.knn.dist</code>). A smaller <code>mean.knn.dist</code> means a good projection.</p>
<p><img src="../reference/figures/mean-knn-dist.png" /></p>
<p>To access the p-value of a given <code>mean.knn.dist</code>, we build the null distribution by calculating the randomly selected K nearest neighbors for the given cell and repeat the process by 1000 times. Then the empirical p values were calculated according to this null distribution. Adjusted p values were calculated by Benjamini-Hochberg Procedure.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data.plot <span class="ot">&lt;-</span> <span class="fu">FetchData</span>(seu.q, <span class="at">vars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;refUMAP_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="st">&quot;mean.knn.dist&quot;</span>, <span class="st">&quot;mapQ.p.adj&quot;</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data.plot, <span class="fu">aes</span>(mean.knn.dist, <span class="sc">-</span><span class="fu">log10</span>(mapQ.p.adj))) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">4</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="quick_start_files/figure-html/map_qc_threshold-1.png" width="480" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data.plot <span class="ot">&lt;-</span> <span class="fu">FetchData</span>(seu.q, <span class="at">vars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;refUMAP_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="st">&quot;mean.knn.dist&quot;</span>, <span class="st">&quot;mapQ.p.adj&quot;</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>cut.off <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>low.qual.prop <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(data.plot<span class="sc">$</span>mean.knn.dist <span class="sc">&gt;</span> cut.off))[<span class="st">&quot;TRUE&quot;</span>]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>low.qual.prop <span class="ot">&lt;-</span> <span class="fu">round</span>(low.qual.prop, <span class="dv">4</span>) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data.plot, <span class="fu">aes</span>(refUMAP_1, refUMAP_2)) <span class="sc">+</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> mean.knn.dist), <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mapping quality&quot;</span>) <span class="sc">+</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data.plot, <span class="fu">aes</span>(mean.knn.dist)) <span class="sc">+</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> cut.off, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Distribution of mean </span><span class="sc">\n</span><span class="st">kNN dist&quot;</span>) <span class="sc">+</span> </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data.plot, <span class="fu">aes</span>(refUMAP_1, refUMAP_2)) <span class="sc">+</span> </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> mean.knn.dist <span class="sc">&gt;</span> cut.off, <span class="at">size =</span> mean.knn.dist <span class="sc">&gt;</span> cut.off)) <span class="sc">+</span> </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Low-quality projection</span><span class="sc">\n</span><span class="st">(%s%%)&quot;</span>, low.qual.prop)) <span class="sc">+</span> </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="fu">sprintf</span>(<span class="st">&quot;mean.knn.dist</span><span class="sc">\n</span><span class="st">(&gt;%s)&quot;</span>, cut.off))) <span class="sc">+</span> </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code></pre></div>
<p><img src="quick_start_files/figure-html/map_qc_plot-1.png" width="1344" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>seu.q<span class="sc">$</span>cell_subtype2 <span class="ot">&lt;-</span> seu.q<span class="sc">$</span>cell_subtype</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotProjection</span>(seu.q, reference, <span class="at">split.by =</span> <span class="st">&quot;cell_subtype2&quot;</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">ref.color.by =</span> <span class="st">&quot;cell_subtype&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">ref.size =</span> .<span class="dv">5</span>, <span class="at">ref.alpha =</span> .<span class="dv">3</span>, <span class="at">query.size =</span> <span class="dv">1</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">query.alpha =</span> .<span class="dv">5</span>, <span class="at">n.row =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="quick_start_files/figure-html/projection_plot-1.png" width="1728" /></p>
</div>
<div id="label-transfer" class="section level3">
<h3>Label transfer</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>seu.q <span class="ot">&lt;-</span> ProjectSVR<span class="sc">::</span><span class="fu">LabelTransfer</span>(seu.q, reference, <span class="at">ref.label.col =</span> <span class="st">&quot;cell_subtype&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(seu.q, <span class="at">reduction =</span> <span class="st">&quot;ref.umap&quot;</span>, <span class="at">group.by =</span> <span class="st">&quot;knn.pred.celltype&quot;</span>) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> reference<span class="sc">$</span>ref.cellmeta<span class="sc">$</span>colors)</span></code></pre></div>
<p><img src="quick_start_files/figure-html/label_transfer-1.png" width="864" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data.stat <span class="ot">&lt;-</span> <span class="fu">table</span>(seu.q<span class="sc">$</span>cell_subtype, seu.q<span class="sc">$</span>knn.pred.celltype)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="sc">::</span><span class="fu">pheatmap</span>(data.stat, <span class="at">display_numbers =</span> T, <span class="at">number_format =</span> <span class="st">&quot;%.0f&quot;</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">number_color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="quick_start_files/figure-html/compare_heatmap-1.png" width="768" /></p>
<details>
<summary>
<strong>Session Info</strong>
</summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.1.2 (2021-11-01)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: CentOS Linux 7 (Core)
## 
## Matrix products: default
## BLAS:   /opt/R4.1/lib64/R/lib/libRblas.so
## LAPACK: /opt/R4.1/lib64/R/lib/libRlapack.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] forcats_0.5.2         stringr_1.4.1         dplyr_1.0.10         
##  [4] purrr_0.3.4           readr_2.1.2           tidyr_1.2.1          
##  [7] tibble_3.1.8          ggplot2_3.4.1         tidyverse_1.3.2      
## [10] sp_1.5-0              SeuratObject_4.1.2    Seurat_4.2.0         
## [13] ProjectSVR_0.1.0.9000
## 
## loaded via a namespace (and not attached):
##   [1] utf8_1.2.2             reticulate_1.26        tidyselect_1.1.2      
##   [4] mlr3learners_0.5.4     htmlwidgets_1.5.4      BiocParallel_1.28.3   
##   [7] grid_4.1.2             Rtsne_0.16             mlr3misc_0.11.0       
##  [10] munsell_0.5.0          codetools_0.2-18       bbotk_0.5.4           
##  [13] ragg_1.2.2             ica_1.0-3              future_1.28.0         
##  [16] miniUI_0.1.1.1         mlr3verse_0.2.5        withr_2.5.0           
##  [19] spatstat.random_3.0-1  colorspace_2.0-3       progressr_0.11.0      
##  [22] highr_0.9              knitr_1.40             uuid_1.1-0            
##  [25] rstudioapi_0.14        stats4_4.1.2           ROCR_1.0-11           
##  [28] tensor_1.5             listenv_0.8.0          labeling_0.4.2        
##  [31] mlr3tuning_0.14.0      lgr_0.4.4              polyclip_1.10-0       
##  [34] pheatmap_1.0.12        farver_2.1.1           rprojroot_2.0.3       
##  [37] parallelly_1.32.1      vctrs_0.5.1            generics_0.1.3        
##  [40] clusterCrit_1.2.8      xfun_0.33              R6_2.5.1              
##  [43] doParallel_1.0.17      clue_0.3-61            isoband_0.2.5         
##  [46] spatstat.utils_3.0-1   cachem_1.0.6           assertthat_0.2.1      
##  [49] promises_1.2.0.1       scales_1.2.1           googlesheets4_1.0.1   
##  [52] rgeos_0.5-9            gtable_0.3.1           globals_0.16.1        
##  [55] goftest_1.2-3          rlang_1.0.6            systemfonts_1.0.4     
##  [58] GlobalOptions_0.1.2    splines_4.1.2          lazyeval_0.2.2        
##  [61] gargle_1.2.1           paradox_0.10.0         spatstat.geom_3.0-3   
##  [64] broom_1.0.1            checkmate_2.1.0        modelr_0.1.9          
##  [67] yaml_2.3.5             reshape2_1.4.4         abind_1.4-5           
##  [70] mlr3_0.14.0            backports_1.4.1        httpuv_1.6.6          
##  [73] tools_4.1.2            ellipsis_0.3.2         spatstat.core_2.4-4   
##  [76] jquerylib_0.1.4        RColorBrewer_1.1-3     BiocGenerics_0.40.0   
##  [79] ggridges_0.5.3         Rcpp_1.0.9             plyr_1.8.7            
##  [82] rpart_4.1.16           deldir_1.0-6           pbapply_1.5-0         
##  [85] GetoptLong_1.0.5       cowplot_1.1.1          S4Vectors_0.32.4      
##  [88] zoo_1.8-11             haven_2.5.1            ggrepel_0.9.1         
##  [91] cluster_2.1.4          here_1.0.1             fs_1.5.2              
##  [94] magrittr_2.0.3         data.table_1.14.2      scattermore_0.8       
##  [97] circlize_0.4.15        reprex_2.0.2           lmtest_0.9-40         
## [100] RANN_2.6.1             googledrive_2.0.0      fitdistrplus_1.1-8    
## [103] matrixStats_0.62.0     hms_1.1.2              patchwork_1.1.2       
## [106] mime_0.12              evaluate_0.16          xtable_1.8-4          
## [109] readxl_1.4.1           IRanges_2.28.0         gridExtra_2.3         
## [112] shape_1.4.6            UCell_1.3.1            compiler_4.1.2        
## [115] mlr3cluster_0.1.4      KernSmooth_2.23-20     crayon_1.5.1          
## [118] htmltools_0.5.3        tzdb_0.3.0             mgcv_1.8-40           
## [121] later_1.3.0            lubridate_1.8.0        DBI_1.1.3             
## [124] dbplyr_2.2.1           ComplexHeatmap_2.10.0  rappdirs_0.3.3        
## [127] MASS_7.3-58.1          mlr3data_0.6.1         Matrix_1.5-1          
## [130] cli_3.4.1              parallel_4.1.2         igraph_1.3.5          
## [133] pkgconfig_2.0.3        pkgdown_2.0.6          plotly_4.10.0         
## [136] spatstat.sparse_3.0-0  xml2_1.3.3             foreach_1.5.2         
## [139] bslib_0.4.0            mlr3fselect_0.7.2      rvest_1.0.3           
## [142] digest_0.6.29          sctransform_0.3.5      RcppAnnoy_0.0.19      
## [145] mlr3filters_0.6.0      spatstat.data_3.0-0    cellranger_1.1.0      
## [148] rmarkdown_2.16         leiden_0.4.3           uwot_0.1.14           
## [151] curl_5.0.1             shiny_1.7.2            rjson_0.2.21          
## [154] lifecycle_1.0.3        nlme_3.1-155           jsonlite_1.8.0        
## [157] mlr3tuningspaces_0.3.0 desc_1.4.2             viridisLite_0.4.1     
## [160] fansi_1.0.3            pillar_1.8.1           ggsci_2.9             
## [163] lattice_0.20-45        fastmap_1.1.0          httr_1.4.4            
## [166] survival_3.4-0         glue_1.6.2             mlr3viz_0.5.10        
## [169] png_0.1-7              iterators_1.0.14       stringi_1.7.6         
## [172] sass_0.4.2             mlr3pipelines_0.4.2    palmerpenguins_0.1.1  
## [175] textshaping_0.3.6      memoise_2.0.1          irlba_2.3.5           
## [178] future.apply_1.9.1</code></pre>
</details>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
      </div>

</div>



      <footer><div class="copyright">
  <p></p><p>Developed by Jianing Gao.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>
